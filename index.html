<script>
/* ðŸ”Œ SERVICE WORKER */
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}

/* ðŸ”’ ELEMENTLER */
const music = document.getElementById("bgMusic");
const voice = document.getElementById("voice");
const musicBtn = document.getElementById("musicBtn");
const playVoice = document.getElementById("playVoice");
const yes = document.getElementById("yes");
const no = document.getElementById("no");
const heartMain = document.querySelector(".heart");

/* ðŸŽµ MÃœZÄ°K */
let playing=false;
function toggleMusic(){
  if(!playing){
    music.volume=0.6;
    music.play().catch(()=>{});
    playing=true;
    musicBtn.innerText="â¸ï¸";
  }else{
    music.pause();
    playing=false;
    musicBtn.innerText="ðŸŽµ";
  }
}
document.addEventListener("click",()=>{
  if(!playing) toggleMusic();
},{once:true});
musicBtn.onclick=toggleMusic;

/* ðŸŽ¤ SESLÄ° MESAJ + BLUR + SENKRON */
playVoice.onclick = () => {
  // mÃ¼zik durdur
  if (!music.paused) {
    music.pause();
    playing = false;
    musicBtn.innerText = "ðŸŽµ";
  }

  // blur aÃ§
  document.querySelector(".overlay").style.background = "rgba(0,0,0,.8)";
  heartMain.style.animation = "beat 0.4s infinite";

  voice.currentTime = 0;
  voice.play().catch(()=>{});

  // kalp efekti
  voiceHeartInterval = setInterval(createHeart, 300);
};

voice.onended = () => {
  clearInterval(voiceHeartInterval);
  document.querySelector(".overlay").style.background = "rgba(0,0,0,.6)";
  heartMain.style.animation = "beat 1s infinite";
  toggleMusic();
};

/* â±ï¸ SAYAÃ‡ */
const startDate=new Date("2023-02-14T00:00:00");
function updateCounter(){
  const diff=new Date()-startDate;
  document.getElementById("counter").innerText =
    Math.floor(diff/(1000*60*60*24)) + " gÃ¼n";
}
setInterval(updateCounter,1000);
updateCounter();

/* âŒ HAYIR KAÃ‡SIN */
function kac(){
  no.style.left=Math.random()*(innerWidth-100)+"px";
  no.style.top=Math.random()*(innerHeight-50)+"px";
}
no.onmouseover=kac;
no.ontouchstart=kac;

/* â¤ï¸ KALPLER */
function createHeart(){
  const h=document.createElement("div");
  h.className="heart-float";
  h.innerText="â¤ï¸";
  h.style.left=Math.random()*100+"vw";
  h.style.fontSize=20+Math.random()*30+"px";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),6000);
}

/* ðŸ’– YES â€“ TAM EKRAN ANÄ°MASYON */
yes.onclick = () => {
  const screen = document.createElement("div");
  screen.style.cssText = `
    position:fixed;
    inset:0;
    background:radial-gradient(circle at top,#ff4d6d,#000);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:32px;
    color:white;
    z-index:99999;
    animation:fadeIn 1s forwards;
    text-align:center;
  `;
  screen.innerHTML = "ðŸ’– Seni Ã‡ok Seviyorum Firdevs ðŸ’–";
  document.body.appendChild(screen);

  let rain = setInterval(createHeart, 120);

  setTimeout(()=>{
    clearInterval(rain);
    screen.style.animation = "fadeOut 1s forwards";
    setTimeout(()=>screen.remove(),1000);
  }, 3500);
};

/* ðŸ–¼ï¸ SLIDER */
const memories = document.querySelectorAll(".memory");
let memoryIndex = 0;
setInterval(() => {
  memories[memoryIndex].classList.remove("active");
  memoryIndex = (memoryIndex + 1) % memories.length;
  memories[memoryIndex].classList.add("active");
}, 3000);
</script>
